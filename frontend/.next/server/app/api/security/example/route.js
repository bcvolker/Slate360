"use strict";(()=>{var e={};e.id=497,e.ids=[497],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},72742:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>ea,originalPathname:()=>es,patchFetch:()=>en,requestAsyncStorage:()=>ee,routeModule:()=>J,serverHooks:()=>er,staticGenerationAsyncStorage:()=>et,staticGenerationBailout:()=>ei});var a={};r.r(a),r.d(a,{DELETE:()=>Y,GET:()=>Z,PATCH:()=>Q,POST:()=>W,PUT:()=>N});var i=r(95419),s=r(69108),n=r(99678),o=r(78070),l=r(81355),c=r(82002);class u{async log(e){let t=new Date(e.timestamp).toISOString(),r=e.level.toUpperCase(),a=e.context?` ${JSON.stringify(e.context)}`:"",i=e.userId?` [User: ${e.userId}]`:"";console.log(`[${t}] ${r}${i}: ${e.message}${a}`),e.error&&console.error("Error details:",e.error)}async logSecurityEvent(e){let t=new Date(e.timestamp).toISOString(),r=e.severity.toUpperCase(),a=e.userId?` [User: ${e.userId}]`:"";console.warn(`[${t}] SECURITY ${r}${a}: ${e.event} - ${e.description}`),console.warn("Event details:",e.details)}}class d{constructor(e=[new u]){this.transports=[],this.requestIdCounter=0,this.transports=e}addTransport(e){this.transports.push(e)}generateRequestId(){return`req_${Date.now()}_${++this.requestIdCounter}`}async log(e,t,r,a){let i={timestamp:new Date().toISOString(),level:e,message:t,context:r,...a};await Promise.all(this.transports.map(e=>e.log(i)))}async logSecurityEvent(e,t,r,a,i,s){let n={type:e,severity:t,event:r,description:a,details:i,timestamp:new Date().toISOString(),...s};await Promise.all(this.transports.map(e=>e.logSecurityEvent(n)))}async error(e,t,r){return this.log("error",e,t,r)}async warn(e,t,r){return this.log("warn",e,t,r)}async info(e,t,r){return this.log("info",e,t,r)}async debug(e,t,r){return this.log("debug",e,t,r)}async logAuthentication(e,t,r,a){let i=e.includes("failure")?"high":"low",s=`Authentication event: ${e}`;await this.logSecurityEvent("authentication",i,e,s,r,{userId:t,...a})}async logAuthorization(e,t,r,a,i){let s=e.includes("denied")?"medium":"low",n=`Authorization event: ${e} for resource ${r}`;await this.logSecurityEvent("authorization",s,e,n,{resource:r,...a},{userId:t,...i})}async logDataAccess(e,t,r,a,i){let s=e.includes("delete")||e.includes("export")?"medium":"low",n=`Data access event: ${e} on resource ${r}`;await this.logSecurityEvent("data_access",s,e,n,{resource:r,...a},{userId:t,...i})}async logSystemEvent(e,t){let r=e.includes("shutdown")||e.includes("update")?"medium":"low",a=`System event: ${e}`;await this.logSecurityEvent("system",r,e,a,t)}async logSecurityIncident(e,t,r,a,i){await this.logSecurityEvent("security",t,e,r,a,i)}}let m=new d,h=(e,t,r,a,i,s)=>m.logSecurityEvent(e,t,r,a,i,s);class A{constructor(){this.errorCounts=new Map,this.lastReset=Date.now(),setInterval(()=>{this.errorCounts.clear(),this.lastReset=Date.now()},36e5)}static getInstance(){return A.instance||(A.instance=new A),A.instance}async handleError(e,t,r={}){let a=this.generateRequestId(),i=new Date().toISOString(),s=this.determineSeverity(e,r),n=this.determineCategory(e,r),o=this.determineStatus(s,n),l={code:this.generateErrorCode(e,n),message:this.sanitizeErrorMessage(e),status:o,severity:s,category:n,details:r.details,timestamp:i,requestId:a,userId:r.userId,ipAddress:this.getClientIP(t),userAgent:t.headers.get("user-agent")||"unknown",path:t.nextUrl.pathname,method:t.method};return await this.logSecurityError(l),await this.analyzeSecurityThreat(l),this.createErrorResponse(l)}async handleAuthError(e,t,r){return this.handleError(e,t,{userId:r,severity:"high",category:"authentication",details:{authAttempt:!0}})}async handleAuthzError(e,t,r,a){return this.handleError(e,t,{userId:r,severity:"medium",category:"authorization",details:{resource:a,accessDenied:!0}})}async handleValidationError(e,t,r,a){return this.handleError(e,t,{userId:r,severity:"low",category:"validation",details:{field:a,validationFailed:!0}})}async handleSystemError(e,t,r){return this.handleError(e,t,{userId:r,severity:"medium",category:"system",details:{systemError:!0}})}determineSeverity(e,t){if(t.severity)return t.severity;let r=(e instanceof Error?e.message:e).toLowerCase();return r.includes("sql injection")||r.includes("xss")||r.includes("csrf")||r.includes("authentication bypass")?"critical":r.includes("unauthorized")||r.includes("forbidden")||r.includes("authentication failed")?"high":r.includes("validation")||r.includes("invalid input")||r.includes("rate limit")?"medium":"low"}determineCategory(e,t){if(t.category)return t.category;let r=(e instanceof Error?e.message:e).toLowerCase();return r.includes("auth")||r.includes("login")||r.includes("password")?"authentication":r.includes("permission")||r.includes("access")||r.includes("role")?"authorization":r.includes("validation")||r.includes("invalid")||r.includes("format")?"validation":r.includes("security")||r.includes("threat")||r.includes("attack")?"security":"system"}determineStatus(e,t){return"critical"===e?500:"authentication"===t?401:"authorization"===t?403:"validation"===t?400:"high"===e?500:"medium"===e?422:400}generateErrorCode(e,t){let r=t.toUpperCase().substring(0,3),a=Date.now().toString(36),i=Math.random().toString(36).substring(2,6);return`${r}_${a}_${i}`}sanitizeErrorMessage(e){let t=(e instanceof Error?e.message:e).replace(/password\s*=\s*['"][^'"]*['"]/gi,"password=***").replace(/token\s*=\s*['"][^'"]*['"]/gi,"token=***").replace(/secret\s*=\s*['"][^'"]*['"]/gi,"secret=***").replace(/key\s*=\s*['"][^'"]*['"]/gi,"key=***").replace(/api[_-]?key\s*=\s*['"][^'"]*['"]/gi,"api_key=***").replace(/database\s*=\s*['"][^'"]*['"]/gi,"database=***").replace(/host\s*=\s*['"][^'"]*['"]/gi,"host=***").replace(/port\s*=\s*\d+/gi,"port=***");return(t=t.replace(/at\s+.*\s+\(.*\)/g,"").replace(/\/[^\/]*\/node_modules\/[^\/]*/g,"").replace(/\/[^\/]*\/src\/[^\/]*/g,"").replace(/\/[^\/]*\/dist\/[^\/]*/g,"")).length>200&&(t=t.substring(0,200)+"..."),t.trim()||"An error occurred"}getClientIP(e){return e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()||e.headers.get("x-real-ip")||e.ip||"unknown"}generateRequestId(){return`req_${Date.now()}_${Math.random().toString(36).substring(2,8)}`}async logSecurityError(e){try{await m.logSecurityEvent(e.category,e.severity,e.code,e.message,{status:e.status,path:e.path,method:e.method,requestId:e.requestId,details:e.details},{userId:e.userId,ipAddress:e.ipAddress,userAgent:e.userAgent,requestId:e.requestId}),this.trackError(e)}catch(e){console.error("Failed to log security error:",e)}}trackError(e){let t=`${e.category}_${e.severity}_${e.ipAddress}`,r=this.errorCounts.get(t)||0;this.errorCounts.set(t,r+1)}async analyzeSecurityThreat(e){try{if("authentication"===e.category&&"high"===e.severity){let t=`auth_high_${e.ipAddress}`,r=this.errorCounts.get(t)||0;r>5&&await m.logSecurityEvent("security","critical","brute_force_detected",`Multiple authentication failures from IP ${e.ipAddress}`,{failureCount:r,ipAddress:e.ipAddress,timeWindow:"1 hour"},{ipAddress:e.ipAddress,requestId:e.requestId})}("critical"===e.severity||"security"===e.category)&&await m.logSecurityEvent("security","critical","security_threat_detected",`Critical security error: ${e.message}`,{errorCode:e.code,category:e.category,severity:e.severity,path:e.path,method:e.method},{userId:e.userId,ipAddress:e.ipAddress,requestId:e.requestId})}catch(e){console.error("Failed to analyze security threat:",e)}}createErrorResponse(e){let t={error:e.message,code:e.code,requestId:e.requestId,timestamp:e.timestamp};return o.Z.json(t,{status:e.status})}getErrorStats(){return Date.now(),{totalErrors:Array.from(this.errorCounts.values()).reduce((e,t)=>e+t,0),recentErrors:Array.from(this.errorCounts.entries()).filter(([e,t])=>t>0).reduce((e,[t,r])=>e+r,0),errorCounts:Object.fromEntries(this.errorCounts),lastReset:new Date(this.lastReset).toISOString()}}}let p=A.getInstance();var g=r(6113),y=r.n(g);class f{constructor(e={},t){this.config={maxFileSize:10485760,allowedMimeTypes:["image/jpeg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/csv"],allowedExtensions:[".jpg",".jpeg",".png",".gif",".webp",".pdf",".doc",".docx",".xls",".xlsx",".txt",".csv"],scanForMalware:!0,virusTotalApiKey:process.env.VIRUS_TOTAL_API_KEY,clamAVEnabled:!!process.env.CLAMAV_HOST,clamAVHost:process.env.CLAMAV_HOST||"localhost",clamAVPort:parseInt(process.env.CLAMAV_PORT||"3310"),...e},this.uploadConfig=t}async validateFile(e,t){let r=[],a=[],i="";try{let s;let n=e instanceof File?e.size:e.length;n>this.config.maxFileSize&&r.push(`File size (${this.formatBytes(n)}) exceeds maximum allowed size (${this.formatBytes(this.config.maxFileSize)})`);let o=this.getFileExtension(t);this.config.allowedExtensions.includes(o.toLowerCase())||r.push(`File extension '${o}' is not allowed. Allowed extensions: ${this.config.allowedExtensions.join(", ")}`),e instanceof File&&!this.config.allowedMimeTypes.includes(e.type)&&r.push(`File type '${e.type}' is not allowed. Allowed types: ${this.config.allowedMimeTypes.join(", ")}`),i=await this.generateFileHash(e);let l=this.detectSuspiciousPatterns(t,e);return l.length>0&&a.push(`Suspicious patterns detected: ${l.join(", ")}`),this.config.scanForMalware&&!(s=await this.scanForMalware(e,i)).isClean&&r.push(`Malware detected: ${s.threats.join(", ")}`),{isValid:0===r.length,errors:r,warnings:a,fileHash:i,scanResult:s}}catch(e){return r.push(`File validation failed: ${e instanceof Error?e.message:"Unknown error"}`),{isValid:!1,errors:r,warnings:a,fileHash:i}}}async generateFileHash(e){if(!(e instanceof File))return y().createHash("sha256").update(e).digest("hex");{let t=await e.arrayBuffer(),r=Buffer.from(t);return y().createHash("sha256").update(r).digest("hex")}}getFileExtension(e){let t=e.lastIndexOf(".");return -1!==t?e.substring(t):""}formatBytes(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}detectSuspiciousPatterns(e,t){let r=[],a=e.toLowerCase();for(let e of["cmd","bat","exe","scr","pif","com","vbs","js","jar","msi","dll","sys","drv","scr","hta","wsf","wsh","ps1","psm1"])a.includes(e)&&r.push(`Suspicious filename pattern: ${e}`);return(e.match(/\./g)||[]).length>1&&r.push("Multiple file extensions detected"),e.length>255&&r.push("Filename is unusually long"),/[^\w\s\-\.]/g.test(e)&&r.push("Filename contains special characters"),r}async scanForMalware(e,t){let r=[];if(this.config.virusTotalApiKey)try{let e=await this.scanWithVirusTotal(t);e.isClean||r.push(...e.threats)}catch(e){console.warn("VirusTotal scan failed:",e)}if(this.config.clamAVEnabled)try{let t=await this.scanWithClamAV(e);t.isClean||r.push(...t.threats)}catch(e){console.warn("ClamAV scan failed:",e)}let a=this.performHeuristicScan(e);return r.push(...a),{isClean:0===r.length,threats:r,scanProvider:"Multi-engine scan",scanTimestamp:new Date().toISOString()}}async scanWithVirusTotal(e){try{let t=await fetch(`https://www.virustotal.com/vtapi/v2/file/report?apikey=${this.config.virusTotalApiKey}&resource=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error(`VirusTotal API error: ${t.status}`);let r=await t.json();if(1===r.response_code){let e=r.positives||0;if(r.total,e>0){let e=Object.keys(r.scans||{}).filter(e=>r.scans[e].detected).map(e=>`${e}: ${r.scans[e].result}`);return{isClean:!1,threats:e}}}return{isClean:!0,threats:[]}}catch(e){return console.error("VirusTotal scan error:",e),{isClean:!0,threats:[]}}}async scanWithClamAV(e){try{let t=e instanceof File?Buffer.from(await e.arrayBuffer()):e,r=!this.detectClamAVThreats(t);return{isClean:r,threats:r?[]:["ClamAV: Potential threat detected"]}}catch(e){return console.error("ClamAV scan error:",e),{isClean:!0,threats:[]}}}detectClamAVThreats(e){let t=e.toString("utf8",0,Math.min(e.length,1e3));return["X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*","TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAATAEDAFKmq1UAAAAAAAAAAOAAIiALgAAAAAABAAgAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAAABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAGQEAABPAAAAAEAAAIgDAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAwAAADcQAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="].some(e=>t.includes(e))}performHeuristicScan(e){let t=[];try{let r=e instanceof File?Buffer.from(e.slice(0,1024).arrayBuffer()):e.slice(0,1024);for(let e of[Buffer.from([77,90]),Buffer.from([127,69,76,70]),Buffer.from([254,237,250,206]),Buffer.from([207,250,237,254])])if(r.includes(e)){t.push("Heuristic: Executable file signature detected");break}let a=r.toString("utf8",0,Math.min(r.length,1e3));for(let e of[/<script\b[^>]*>/i,/javascript:/i,/vbscript:/i,/on\w+\s*=/i,/eval\s*\(/i,/document\.write/i])if(e.test(a)){t.push("Heuristic: Script content detected");break}}catch(e){console.warn("Heuristic scan failed:",e)}return t}async generateSecureUploadURL(e,t,r){let a=`uploads/${r}/${e}`,i=new Date(Date.now()+1e3*this.uploadConfig.presignedUrlExpiry).toISOString();return{uploadUrl:`https://${this.uploadConfig.bucket}.s3.${this.uploadConfig.region}.amazonaws.com/${a}?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=${this.uploadConfig.accessKeyId}&X-Amz-Date=${new Date().toISOString().split("T")[0]}&X-Amz-Expires=${this.uploadConfig.presignedUrlExpiry}&X-Amz-SignedHeaders=host&X-Amz-Signature=signature`,fileKey:a,expiresAt:i}}getStats(){return{maxFileSize:this.formatBytes(this.config.maxFileSize),allowedMimeTypes:this.config.allowedMimeTypes.length,allowedExtensions:this.config.allowedExtensions.length,malwareScanning:this.config.scanForMalware,virusTotalEnabled:!!this.config.virusTotalApiKey,clamAVEnabled:this.config.clamAVEnabled,encryption:this.uploadConfig.encryption,presignedUrlExpiry:this.uploadConfig.presignedUrlExpiry}}}let w={maxFileSize:10485760,allowedMimeTypes:["image/jpeg","image/png","image/gif","image/webp","application/pdf","text/plain","text/csv"],allowedExtensions:[".jpg",".jpeg",".png",".gif",".webp",".pdf",".txt",".csv"],scanForMalware:!0,virusTotalApiKey:process.env.VIRUS_TOTAL_API_KEY,clamAVEnabled:!!process.env.CLAMAV_HOST,clamAVHost:process.env.CLAMAV_HOST,clamAVPort:parseInt(process.env.CLAMAV_PORT||"3310")},S=(e,t,r)=>new f(r||w,{bucket:process.env.AWS_S3_BUCKET||"slate360-uploads",region:process.env.AWS_S3_REGION||"us-east-1",accessKeyId:process.env.AWS_ACCESS_KEY_ID||"",secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY||"",encryption:"AES256",presignedUrlExpiry:3600,publicRead:!1}).validateFile(e,t);class v{constructor(){this.routeConfigs=new Map,this.middlewares=[],this.initializeDefaultMiddlewares()}static getInstance(){return v.instance||(v.instance=new v),v.instance}initializeDefaultMiddlewares(){this.addMiddleware({name:"authentication",priority:1,handler:this.authenticateRequest.bind(this)}),this.addMiddleware({name:"csrf",priority:2,handler:this.validateCSRF.bind(this)}),this.addMiddleware({name:"rateLimit",priority:3,handler:this.checkRateLimit.bind(this)}),this.addMiddleware({name:"inputValidation",priority:4,handler:this.validateInput.bind(this)}),this.addMiddleware({name:"authorization",priority:5,handler:this.authorizeRequest.bind(this)}),this.addMiddleware({name:"logging",priority:6,handler:this.logRequest.bind(this)})}addMiddleware(e){this.middlewares.push(e),this.middlewares.sort((e,t)=>e.priority-t.priority)}registerRoute(e){let t=`${e.method}:${e.path}`;this.routeConfigs.set(t,e)}getRouteConfig(e,t){let r=`${e}:${t}`;return this.routeConfigs.get(r)}async secureRoute(e,t){try{let r=e.method,a=e.nextUrl.pathname,i=this.getRouteConfig(r,a);if(!i)return this.applySecurityMiddleware(e,{path:a,method:r,requireAuth:!0,requireCSRF:!0,rateLimit:!0,validateInput:!0},t);return this.applySecurityMiddleware(e,i,t)}catch(t){return console.error("API security error:",t),p.handleSystemError("API security check failed",e)}}async applySecurityMiddleware(e,t,r){try{for(let r of this.middlewares){if(!this.shouldApplyMiddleware(r,t))continue;let a=await r.handler(e,t);if(a)return a}return await r(e)}catch(t){return console.error("Security middleware error:",t),p.handleSystemError("Security middleware failed",e)}}shouldApplyMiddleware(e,t){switch(e.name){case"authentication":return t.requireAuth;case"csrf":return t.requireCSRF;case"rateLimit":return t.rateLimit;case"inputValidation":return t.validateInput;case"authorization":return t.roles||t.tiers;default:return!0}}async authenticateRequest(e,t){try{let t=await (0,l.getServerSession)(c.L);if(!t)return p.handleAuthError("Authentication required",e);return e.session=t,null}catch(t){return p.handleAuthError("Authentication failed",e)}}async validateCSRF(e,t){try{if("GET"===e.method)return null;let t=e.headers.get("x-csrf-token")||(await e.json())._csrf;if(!t)return p.handleValidationError("CSRF token required",e,void 0,"csrf");if(!await this.validateCSRFToken(t,e))return p.handleValidationError("Invalid CSRF token",e,void 0,"csrf");return null}catch(t){return p.handleValidationError("CSRF validation failed",e,void 0,"csrf")}}async checkRateLimit(e,t){try{let r=this.getClientIP(e),a=e.session?.user?.id;if(!await this.checkRateLimit(r,a,t))return p.handleValidationError("Rate limit exceeded",e,a);return null}catch(t){return p.handleSystemError("Rate limit check failed",e)}}async validateInput(e,t){try{let r;if(!t.validateSchema)return null;try{r=await e.json()}catch{return null}let a=t.validateSchema.safeParse(r);if(!a.success)return p.handleValidationError("Invalid input data",e,e.session?.user?.id,"input");return e.validatedData=a.data,null}catch(t){return p.handleValidationError("Input validation failed",e,e.session?.user?.id)}}async authorizeRequest(e,t){try{let r=e.session;if(!r)return null;if(t.roles&&!t.roles.includes(r.user.role))return p.handleAuthzError("Insufficient permissions",e,r.user.id,"role");if(t.tiers&&!t.tiers.includes(r.user.tier))return p.handleAuthzError("Subscription tier required",e,r.user.id,"tier");if(t.customValidation&&!await t.customValidation(e,r))return p.handleAuthzError("Custom validation failed",e,r.user.id,"custom");return null}catch(t){return p.handleAuthzError("Authorization check failed",e,e.session?.user?.id)}}async logRequest(e,t){try{let r=e.session,a=this.getClientIP(e),i=e.headers.get("user-agent")||"unknown";return await m.info("API Request",{method:e.method,path:e.nextUrl.pathname,userId:r?.user?.id,ipAddress:a,userAgent:i,timestamp:new Date().toISOString(),config:{requireAuth:t.requireAuth,requireCSRF:t.requireCSRF,rateLimit:t.rateLimit,roles:t.roles,tiers:t.tiers}}),null}catch(e){return console.error("Request logging failed:",e),null}}async validateCSRFToken(e,t){try{return e.length>0}catch{return!1}}async checkRateLimit(e,t,r){try{return!0}catch{return!1}}getClientIP(e){return e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()||e.headers.get("x-real-ip")||e.ip||"unknown"}createSecureResponse(e,t=200){let r=o.Z.json(e,{status:t});return r.headers.set("X-Content-Type-Options","nosniff"),r.headers.set("X-Frame-Options","DENY"),r.headers.set("X-XSS-Protection","1; mode=block"),r}async validateFileUpload(e,t){try{let r=await S(e,e.name);return r.isValid||await m.warn("File upload validation failed",{filename:e.name,errors:r.errors,warnings:r.warnings,ipAddress:this.getClientIP(t),userId:t.session?.user?.id}),{isValid:r.isValid,errors:r.errors,warnings:r.warnings}}catch(r){return await m.error("File validation error",{filename:e.name,error:r instanceof Error?r.message:"Unknown error",ipAddress:this.getClientIP(t)}),{isValid:!1,errors:["File validation failed"],warnings:[]}}}getStats(){return{registeredRoutes:this.routeConfigs.size,activeMiddlewares:this.middlewares.length,middlewareNames:this.middlewares.map(e=>e.name),routeConfigs:Array.from(this.routeConfigs.values()).map(e=>({path:e.path,method:e.method,requireAuth:e.requireAuth,requireCSRF:e.requireCSRF,rateLimit:e.rateLimit,roles:e.roles,tiers:e.tiers}))}}}let E=v.getInstance(),x=(e,t)=>(E.registerRoute(e),async e=>E.secureRoute(e,t)),C=(e,t)=>E.createSecureResponse(e,t),I=(e,t)=>({path:"/api/route",method:"GET",requireAuth:!0,requireCSRF:!0,rateLimit:!0,roles:e,tiers:t});var R=r(65256);let b=e=>"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim(),T=R.Z_().min(1,"Field is required").max(1e3,"Field must be less than 1000 characters").transform(b),q=R.Z_().email("Invalid email format").max(255,"Email must be less than 255 characters").transform(b);R.Z_().url("Invalid URL format").max(500,"URL must be less than 500 characters").transform(b);let F=R.Z_().regex(/^[\+]?[1-9][\d]{0,15}$/,"Invalid phone number format").max(20,"Phone number must be less than 20 characters").transform(b),_=T.min(3,"Project name must be at least 3 characters").max(100,"Project name must be less than 100 characters"),$=T.min(10,"Description must be at least 10 characters").max(2e3,"Description must be less than 2000 characters"),M=R.Km(["residential","commercial","industrial","infrastructure","renovation","other"]),P=R.Km(["planning","active","on-hold","completed","cancelled"]),V=R.Km(["low","medium","high","critical"]),D=T.min(2,"Client name must be at least 2 characters").max(100,"Client name must be less than 100 characters"),z=T.max(200,"Company name must be less than 200 characters").optional(),k=T.min(5,"Address must be at least 5 characters").max(500,"Address must be less than 500 characters"),U=T.min(2,"City must be at least 2 characters").max(100,"City must be less than 100 characters"),L=T.min(2,"State must be at least 2 characters").max(100,"State must be less than 100 characters"),O=R.Z_().regex(/^\d{5}(-\d{4})?$/,"Invalid ZIP code format").max(10,"ZIP code must be less than 10 characters"),B=R.Ry({estimated:R.Rx().min(0,"Budget must be non-negative").max(1e9,"Budget must be less than 1 billion"),actual:R.Rx().min(0,"Actual cost must be non-negative").max(1e9,"Actual cost must be less than 1 billion").optional(),currency:R.Km(["USD","EUR","GBP","CAD","AUD"]).default("USD")}),j=R.Ry({startDate:R.hT({required_error:"Start date is required",invalid_type_error:"Start date must be a valid date"}),endDate:R.hT({invalid_type_error:"End date must be a valid date"}).optional(),milestones:R.IX(R.Ry({title:T.min(3).max(100),date:R.hT(),description:T.max(500).optional()})).optional()}),H=R.Ry({id:R.Z_().optional(),name:T.min(2).max(100),role:T.min(2).max(100),email:q,phone:F.optional(),hourlyRate:R.Rx().min(0).max(1e3).optional()}),K=R.IX(T.min(2,"Tag must be at least 2 characters").max(50,"Tag must be less than 50 characters")).max(20,"Maximum 20 tags allowed"),G=R.Ry({name:_,description:$,type:M,status:P.default("planning"),priority:V.default("medium"),client:R.Ry({name:D,email:q,company:z,phone:F.optional()}),location:R.Ry({address:k,city:U,state:L,zipCode:O,country:R.Z_().default("USA")}),budget:B,timeline:j.optional(),team:R.IX(H).optional(),tags:K.optional(),notes:T.max(5e3).optional()});G.partial(),R.Ry({query:T.max(200).optional(),status:P.optional(),type:M.optional(),priority:V.optional(),client:T.max(200).optional(),tags:R.IX(T).optional(),dateRange:R.Ry({start:R.hT().optional(),end:R.hT().optional()}).optional(),budgetRange:R.Ry({min:R.Rx().min(0).optional(),max:R.Rx().min(0).optional()}).optional()}),R.Ry({page:R.Rx().min(1).default(1),limit:R.Rx().min(1).max(100).default(20),sortBy:R.Km(["name","status","priority","createdAt","updatedAt"]).default("createdAt"),sortOrder:R.Km(["asc","desc"]).default("desc")});let X=e=>{try{return G.parse(e)}catch{return null}},Z=x(I(),async e=>{try{return await m.info("Security example API accessed",{method:"GET",path:"/api/security/example",userId:"example-user",timestamp:new Date().toISOString()}),C({message:"Security example API working",features:["Authentication required","CSRF protection","Rate limiting","Input validation","Request logging"],timestamp:new Date().toISOString()})}catch(t){return p.handleSystemError(t instanceof Error?t.message:"Unknown error",e)}}),W=x({path:"/api/route",method:"GET",requireAuth:!0,requireCSRF:!0,rateLimit:!0,roles:["admin","ceo"]},async e=>{try{await h("authorization","medium","admin_action","Admin accessed security example API",{action:"POST",resource:"/api/security/example"},{userId:"admin-user",role:"admin"});let t=await e.json(),r=X(t);if(!r)return p.handleValidationError("Invalid project data",e,"admin-user","project");return C({message:"Admin action completed",validatedData:r,timestamp:new Date().toISOString()})}catch(t){return p.handleSystemError(t instanceof Error?t.message:"Unknown error",e)}}),N=x({path:"/api/route",method:"GET",requireAuth:!0,requireCSRF:!0,rateLimit:!0,tiers:["premium","enterprise"]},async e=>{try{return await h("data_access","low","premium_feature_access","Premium user accessed security example API",{action:"PUT",resource:"/api/security/example"},{userId:"premium-user",tier:"premium"}),C({message:"Premium feature accessed",feature:"Advanced security example",timestamp:new Date().toISOString()})}catch(t){return p.handleSystemError(t instanceof Error?t.message:"Unknown error",e)}}),Q=x(I(),async e=>{try{let t=(await e.formData()).get("file");if(t){let r=await S(t,t.name);if(!r.isValid)return await m.warn("File upload validation failed",{filename:t.name,errors:r.errors,warnings:r.warnings,userId:"example-user"}),p.handleValidationError("File validation failed",e,"example-user","file");await h("data_access","low","file_upload_validated","File upload validation successful",{filename:t.name,fileSize:t.size,fileType:t.type},{userId:"example-user"})}return C({message:"File validation completed",fileInfo:t?{name:t.name,size:t.size,type:t.type}:null,timestamp:new Date().toISOString()})}catch(t){return p.handleSystemError(t instanceof Error?t.message:"Unknown error",e)}}),Y=x({path:"/api/security/example",method:"DELETE",requireAuth:!0,requireCSRF:!0,rateLimit:!0,customValidation:async(e,t)=>{let r=t?.user?.role,a=t?.user?.tier;return"admin"===r||"enterprise"===a}},async e=>{try{return await h("data_access","high","resource_deletion","Resource deletion attempted",{action:"DELETE",resource:"/api/security/example",method:"custom_validation"},{userId:"validated-user"}),C({message:"Resource deletion completed",validation:"Custom validation passed",timestamp:new Date().toISOString()})}catch(t){return p.handleSystemError(t instanceof Error?t.message:"Unknown error",e)}}),J=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/security/example/route",pathname:"/api/security/example",filename:"route",bundlePath:"app/api/security/example/route"},resolvedPagePath:"C:\\Slate360\\frontend\\src\\app\\api\\security\\example\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:ee,staticGenerationAsyncStorage:et,serverHooks:er,headerHooks:ea,staticGenerationBailout:ei}=J,es="/api/security/example/route";function en(){return(0,n.patchFetch)({serverHooks:er,staticGenerationAsyncStorage:et})}},82002:(e,t,r)=>{r.d(t,{L:()=>a});let a={providers:[(0,r(86485).Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},authorize:async e=>e?.email&&e?.password?{id:"1",email:e.email,name:"Demo User",role:"user",tier:"free"}:null})],session:{strategy:"jwt",maxAge:86400},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role,e.tier=t.tier),e),session:async({session:e,token:t})=>(t&&(e.user.role=t.role,e.user.tier=t.tier),e)},pages:{signIn:"/auth/signin",error:"/auth/error"},secret:process.env.NEXTAUTH_SECRET}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,457,70,256],()=>r(72742));module.exports=a})();